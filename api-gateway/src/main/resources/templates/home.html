<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
</head>
<body>
<h2>Welcome, <span id="username">Loading...</span>!</h2>

<button id="logoutBtn">Logout</button>

<script>
    // Получаем текущего пользователя
    fetch('/me', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json'
        }
    })
        .then(res => {
            if (res.ok) return res.json();
            else throw new Error('Not logged in');
        })
        .then(data => {
            document.getElementById('username').textContent = data.username;
        })
        .catch(() => {
            alert('You are not logged in');
            window.location.href = '/login-page';
        });

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
        fetch('/logout', {
            method: 'POST'
        }).then(() => {
            alert('Logged out');
            window.location.href = '/login-page';
        });
    });
</script>
</body>
</html>
