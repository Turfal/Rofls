<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roflogram - Нода</title>
    <link th:href="@{/css/profile.css}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<div class="neon-container">
    <!-- Верхняя панель -->
    <header class="flux-header">
        <div class="flux-brand">Roflogram</div>
        <div class="nav-links">
            <a href="/" class="matrix-node"><i class="fas fa-home"></i> Поток</a>
            <button id="logoutBtn" class="logout-node"><i class="fas fa-sign-out-alt"></i> Выход</button>
        </div>
    </header>

    <!-- Контейнер ноды -->
    <div class="profile-container">
        <div class="profile-header">
            <div class="avatar-container">
                <img id="profileAvatar" src="/media/files/raw.png" alt="Аватар ноды">
            </div>
            <div class="profile-info">
                <h2 id="profileUsername">Сканирование...</h2>
                <div class="stats-container">
                    <div class="stat">
                        <span id="postsCount">0</span>
                        <span>импульсов</span>
                    </div>
                    <div class="stat">
                        <span id="commentsCount">0</span>
                        <span>сигналов</span>
                    </div>
                    <div class="stat">
                        <span id="ratingValue">0</span>
                        <span>энергия</span>
                    </div>
                </div>
                <div class="joined-date">Подключение: <span id="joinDate">Сканирование...</span></div>
                <div id="editProfileBtnContainer">
                    <!-- Кнопка редактирования появится здесь для владельца ноды -->
                </div>
            </div>
        </div>

        <div class="profile-bio">
            <p id="profileBio">Сканирование ядра...</p>
        </div>

        <div class="activity-stats">
            <h3>Энергия сети</h3>
            <div class="activity-grid">
                <div class="activity-item">
                    <span class="activity-label">Получено импульсов:</span>
                    <span id="totalUpvotes">0</span>
                </div>
                <div class="activity-item">
                    <span class="activity-label">Сброшено импульсов:</span>
                    <span id="totalDownvotes">0</span>
                </div>
                <div class="activity-item">
                    <span class="activity-label">Последний сигнал:</span>
                    <span id="lastActive">Сканирование...</span>
                </div>
                <div class="activity-item">
                    <span class="activity-label">Достижения:</span>
                    <span id="achievementsCount">0</span>
                </div>
            </div>
        </div>

        <div class="user-posts">
            <h3 id="postsTitle">Ваши импульсы</h3>
            <div id="createPostBtnContainer">
                <!-- Кнопка создания импульса появится здесь для владельца ноды -->
            </div>
            <div id="recentPostsContainer">
                <div class="loading-indicator">Сканирование импульсов...</div>
            </div>
        </div>
    </div>

    <!-- Модальное окно редактирования ноды -->
    <div id="editProfileModal" class="modal">
        <div class="modal-core">
            <div class="modal-head">
                <h3>Настройка ноды</h3>
                <button id="cancelEditBtn" class="close-node">×</button>
            </div>
            <div class="form-group">
                <label for="bioInput">Ядро:</label>
                <textarea id="bioInput" maxlength="200" placeholder="Опишите ваш сигнал..."></textarea>
                <div class="char-counter"><span id="bioCharCount">0</span>/200</div>
            </div>
            <div class="form-group">
                <label for="avatarUrlInput">Идентификатор ноды:</label>
                <input type="text" id="avatarUrlInput" placeholder="https://example.com/avatar.jpg">
                <div class="avatar-preview">
                    <img id="avatarPreview" src="/media/files/raw.png" alt="Предпросмотр идентификатора">
                </div>
            </div>
            <div class="modal-actions">
                <button id="saveProfileBtn" class="submit-node">Сохранить сигнал</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно создания импульса -->
    <div id="postModal" class="modal">
        <div class="modal-core">
            <div class="modal-head">
                <h3>Эмиттировать импульс</h3>
                <button id="cancelPost" class="close-node">×</button>
            </div>
            <textarea id="postText" maxlength="220" placeholder="Ваш сигнал..."></textarea>
            <div class="char-counter"><span id="charCount">0</span>/220</div>
            <div id="mediaPreview" class="media-flux" style="display: none;">
                <div id="previewContainer" class="preview-flux"></div>
                <button id="removeMediaBtn" class="remove-node"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-actions">
                <button id="attachImageBtn" class="attach-node"><i class="fas fa-paperclip"></i></button>
                <input type="file" id="postMediaUpload" style="display: none;" accept="image/*,video/*">
                <button id="submitPost" class="submit-node">Эмиттировать</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно уничтожения импульса -->
    <div id="deleteModal" class="modal">
        <div class="modal-core delete-core">
            <h2>Уничтожить импульс?</h2>
            <p>Это необратимо.</p>
            <div class="modal-actions">
                <button id="cancelDelete" class="cancel-node">Отмена</button>
                <button id="confirmDelete" class="delete-node">Уничтожить</button>
            </div>
        </div>
    </div>

    <!-- Скрытый username для сравнения -->
    <span id="username" style="display: none;"></span>
</div>

<script th:src="@{/js/profile.js}"></script>
</body>
</html>